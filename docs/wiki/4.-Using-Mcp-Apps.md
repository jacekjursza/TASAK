# 4. Using `mcp` Apps

`mcp` applications are a powerful feature of TASAK that allow you to connect to AI-native servers using the **Model Context Protocol (MCP)**. This enables much more advanced and stateful interactions than simple `cmd` apps.

When you configure an `mcp` app, TASAK will connect to the server, discover the "tools" it provides, and dynamically generate a command-line interface for you.

## Configuration

Configuration for an `mcp` app is split into two files.

### 1. `tasak.yaml`

First, you define the app in your `tasak.yaml` file and point it to a separate JSON configuration file.

```yaml
atlassian:
  name: "Atlassian MCP Client"
  type: "mcp"

  # Path to the MCP connection configuration file.
  # You can use ~ and environment variables here.
  config: "~/.mcp/configs/atlassian.json"
```

### 2. MCP Connection JSON

The JSON file contains the specific connection details for the MCP server.

**Example:** `~/.mcp/configs/atlassian.json`
```json
{
  "transport": "sse",
  "url": "https://mcp.atlassian.com/v1/sse",
  "headers": {
    "Authorization": "Bearer ${ATLASSIAN_API_KEY}"
  }
}
```

*   `transport`: The transport protocol. The current version of TASAK only supports `sse` (Server-Sent Events).
*   `url`: The URL of the MCP server.
*   `headers`: A dictionary of HTTP headers to send with the connection request. You can embed environment variables like `${VAR_NAME}` directly in the strings, and TASAK will substitute them.

## Usage

Once configured, you can interact with the MCP app.

### Discovering Tools

To see the list of available tools, you can run the app with `--help`:

```bash
tasak atlassian --help
```

TASAK will connect to the server, get the list of tools, and display them as sub-commands.

### Getting Help for a Specific Tool

To see the arguments for a specific tool, use `--help` on the sub-command:

```bash
tasak atlassian create_ticket --help
```

### Executing a Tool

You can then execute the tool by providing the required arguments:

```bash
tasak atlassian create_ticket --project "PROJ" --summary "My new feature"
```

TASAK will call the remote tool and print the result to the console.

## Caching

To improve performance, TASAK caches the tool definitions it receives from the server. The cache is stored in `~/.tasak/cache/<app_name>.json`.

The cache expires after 15 minutes. To force a refresh, you can use the `--clear-cache` flag:

```bash
tasak atlassian --clear-cache
```
